{"id":"audio_pro-084","title":"Weak validation: electron/main.ts:286 checks for audio stream by searching stderr string - fragile approach","status":"tombstone","priority":2,"issue_type":"bug","created_at":"2025-12-21T11:54:54.171474-06:00","updated_at":"2025-12-21T12:01:32.788329-06:00","deleted_at":"2025-12-21T12:01:32.788329-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"bug"}
{"id":"audio_pro-0hj","title":"Progress UI minimum visibility + terminal dwell","description":"Prevent fast jobs from flashing status too quickly by enforcing minimum visibility times.\n\nProblem: Small jobs complete so fast that progress/status messages flash briefly and users cannot read what happened.\n\nSolution:\n- MIN_VISIBLE_MS = 500ms - Running state must be visible for at least 500ms before terminal state shows\n- TERMINAL_DWELL_MS = 1000ms - Terminal states remain visible for 1s before clearing  \n- Per-job independent timers with proper cleanup\n- Handles multiple jobs without interference\n\nImplementation:\n- JobProgressState interface tracks firstRunningAt, terminalAt, clearTimerId\n- Delay showing terminal if job completes too quickly\n- Schedule clearing after terminal dwell period\n- Clean up timers on unmount and new events\n\nTests: src/__tests__/progress-timing.test.ts (16 tests with fake timers)\n\nBranch: chore/electron-analyzer-v2\nCommit: 276d90c","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T13:50:53.29461-06:00","updated_at":"2025-12-21T13:51:20.123202-06:00","closed_at":"2025-12-21T13:51:20.123202-06:00","close_reason":"Implemented minimum visible duration for progress UI to prevent fast jobs from flashing too quickly.\n\n**Timing Constants (src/App.tsx:35-36)**\n- MIN_VISIBLE_MS = 500ms - Running state minimum visibility before terminal\n- TERMINAL_DWELL_MS = 1000ms - Terminal state visibility duration before clearing\n\n**Per-Job State Tracking (src/App.tsx:38-47)**\n- JobProgressState interface with timing metadata\n- firstRunningAt: timestamp when status became 'running'\n- terminalAt: timestamp when status became terminal\n- clearTimerId: per-job timeout handle for cleanup\n- jobStatesRef: Map tracking multiple independent jobs\n\n**MIN_VISIBLE_MS Enforcement (src/App.tsx:150-170)**\n- Calculate elapsed = now - firstRunningAt when terminal arrives\n- If elapsed \u003c 500ms, delay showing terminal by (500 - elapsed)\n- If elapsed \u003e= 500ms, show terminal immediately\n- Ensures users can read phase/percent even on instant jobs\n\n**TERMINAL_DWELL_MS Enforcement (src/App.tsx:139-148)**\n- Keep terminal states visible for 1000ms before clearing\n- Shows 'Completed', 'Failed', 'Cancelled', 'Timed out' clearly\n- Scheduled clearing removes job from map and clears UI\n\n**Timer Cleanup (src/App.tsx:99-102, 188-197)**\n- Clear existing timer when new event arrives for same job\n- Clear all timers on component unmount\n- Prevents timer leaks and orphaned callbacks\n\n**UI Updates (src/App.tsx:273-308, 689-697)**\n- Status text shows terminal states clearly\n- Progress bar only for 'running'/'queued' states\n- Terminal states visible without progress bar\n\n**Tests (src/__tests__/progress-timing.test.ts)**\n- 16 new tests for timing behavior\n- Tests MIN_VISIBLE_MS delay calculation\n- Tests TERMINAL_DWELL_MS clearing behavior\n- Tests multiple job independence\n- Tests timer cleanup with fake timers\n\n**Results:**\n- Fast jobs no longer flash - always visible ≥500ms\n- Terminal states readable for 1000ms before clearing\n- Cancellation still feels immediate\n- Multiple jobs have independent timers\n- No timer leaks\n- All 102 tests passing (86 previous + 16 new)\n\n**Branch:** chore/electron-analyzer-v2\n**Commit:** 276d90c\n**Prerequisite:** e327e42 (progress reporting)"}
{"id":"audio_pro-197","title":"Bug: extractVideoMetadata lacks timeout (media-metadata.ts:54)","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-25T12:22:39.983483-06:00","updated_at":"2025-12-25T12:22:39.983483-06:00"}
{"id":"audio_pro-2aw","title":"Tech debt: DEPRECATED getTempDir() function still in electron/main.ts","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T06:54:32.944877-06:00","updated_at":"2025-12-23T07:31:14.835422-06:00","closed_at":"2025-12-23T07:31:14.835422-06:00","close_reason":"Closed"}
{"id":"audio_pro-2pf","title":"Bug: final-render.ts no temp dir cleanup on error (final-render.ts:72)","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-25T12:22:42.24586-06:00","updated_at":"2025-12-25T12:22:42.24586-06:00"}
{"id":"audio_pro-337","title":"Bug: media-metadata.ts lacks path validation (main.ts:359)","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-25T12:22:35.047727-06:00","updated_at":"2025-12-25T12:22:35.047727-06:00"}
{"id":"audio_pro-3ca","title":"Bug: Path splitting in App.tsx assumes Unix-style paths (line 154, 273)","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-23T06:54:34.838884-06:00","updated_at":"2025-12-23T07:37:53.136333-06:00","closed_at":"2025-12-23T07:37:53.136333-06:00","close_reason":"Closed"}
{"id":"audio_pro-3cg","title":"TypeScript strict mode disabled: noUnusedLocals and noUnusedParameters set to false in tsconfig.json","status":"tombstone","priority":2,"issue_type":"chore","created_at":"2025-12-21T11:54:48.316029-06:00","updated_at":"2025-12-21T12:01:32.789814-06:00","deleted_at":"2025-12-21T12:01:32.789814-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"chore"}
{"id":"audio_pro-3fi","title":"Hardcoded path construction: electron/main.ts:17,267 uses process.cwd() for tmp dir - breaks if cwd changes or app packaged","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-21T12:07:08.468151-06:00","updated_at":"2025-12-21T12:32:47.033553-06:00","closed_at":"2025-12-21T12:32:47.033553-06:00","close_reason":"Fixed: Replaced process.cwd() with Electron's app.getPath('temp') API. Created getTempDir() helper that uses system temp directory with app-specific subdirectory 'audio-pro-previews'. Works correctly when packaged. Added cleanup handler on app quit to remove preview files. Added 10 test cases verifying temp path behavior and packaging safety."}
{"id":"audio_pro-3wd","title":"Bug: cancel-render IPC missing return type validation","status":"open","priority":3,"issue_type":"bug","created_at":"2025-12-25T12:22:45.264865-06:00","updated_at":"2025-12-25T12:22:45.264865-06:00"}
{"id":"audio_pro-4dz","title":"Security: electron/main.ts:56-64 appfile protocol handler lacks path traversal protection - validates decode but not directory escape","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-21T12:06:54.952142-06:00","updated_at":"2025-12-21T12:25:10.972279-06:00","closed_at":"2025-12-21T12:25:10.972279-06:00","close_reason":"Fixed: Implemented allowlist-based path validation for appfile:// protocol. Only user-selected and app-generated files can be served. Prevents path traversal attacks. Added 13 test cases covering traversal attempts, URL encoding, and platform-specific bypasses."}
{"id":"audio_pro-4hc","title":"electron/main.ts:481,707 approvedFilePaths Set grows unbounded - implement LRU cache or periodic cleanup","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-22T06:11:30.64524-06:00","updated_at":"2025-12-23T07:31:14.834706-06:00","closed_at":"2025-12-23T07:31:14.834706-06:00","close_reason":"Closed"}
{"id":"audio_pro-4lx","title":"Bug: final-render extractSegment/concatSegments no progress reporting","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-25T12:22:41.494426-06:00","updated_at":"2025-12-25T12:22:41.494426-06:00"}
{"id":"audio_pro-4mi","title":"electron/main.ts:828-860 buildFullFilterChain lacks unit tests - move to testable module","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T06:11:33.811551-06:00","updated_at":"2025-12-23T07:25:35.410228-06:00","closed_at":"2025-12-23T07:25:35.410228-06:00","close_reason":"Tests already exist - 881 lines in filter-builders.test.ts with 16 buildFullFilterChain references"}
{"id":"audio_pro-503","title":"Performance: electron/main.ts:281-290 audio probe blocks with runFFmpeg instead of ffprobe - inefficient and parses stderr instead of JSON","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T12:07:01.364996-06:00","updated_at":"2025-12-21T13:01:11.439184-06:00","closed_at":"2025-12-21T13:01:11.439184-06:00","close_reason":"Implemented upstream validation and robust probing:\n\n## Path Validation (DW2)\n\nCreated validateMediaPath() helper (electron/main.ts:63-130):\n- Checks path is absolute\n- Verifies file exists (fs.statSync)\n- Confirms file is regular file (not directory)\n- Validates file is readable (fs.accessSync)\n- Enforces extension allowlist (14 supported formats: .mp4, .mov, .mkv, etc.)\n- Returns typed result with clear failure reasons:\n  NOT_ABSOLUTE, NOT_FOUND, NOT_READABLE, NOT_FILE, UNSUPPORTED_TYPE\n\nWired into render-preview IPC (electron/main.ts:688-696):\n- Validates input path BEFORE any FFmpeg/ffprobe execution\n- Fails fast with clear error messages\n- No process spawn on invalid paths\n\n## Robust Probing (503)\n\nReplaced ffmpeg stderr parsing with ffprobe JSON (electron/main.ts:162-205):\n- Uses ffprobe with -print_format json -show_streams -show_format\n- Parses structured JSON (not fragile regex on stderr)\n- Returns FFprobeResult with typed streams and format\n- Much faster (no video decode needed)\n- Deterministic audio stream detection\n\nUpdated render-preview probe (electron/main.ts:722-741):\n- Calls probeMediaMetadata() instead of runFFmpeg()\n- Checks metadata.streams for codec_type === 'audio'\n- Structured error handling for probe failures\n\n## Test Coverage\n\nAdded electron/__tests__/validation.test.ts (16 tests):\n- Absolute path requirements\n- File existence checks\n- File type validation (reject directories)\n- Extension allowlist enforcement (case-insensitive)\n- Readability checks\n- Edge cases: spaces, unicode, special chars\n- Error message quality\n- All 54 tests passing ✓\n\n## Acceptance Criteria Met\n\n✓ No FFmpeg/ffprobe starts with invalid/unreadable path\n✓ All probing uses ffprobe JSON output\n✓ No stderr parsing for metadata remains\n✓ Errors are deterministic and user-actionable\n✓ Validation is comprehensive (existence, type, permissions, extension)\n✓ Fail-fast design prevents wasted work"}
{"id":"audio_pro-579","title":"Missing tests: src/hooks/useJobProgress.ts has no test coverage for timing enforcement logic","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T06:11:32.859392-06:00","updated_at":"2025-12-22T06:42:20.144842-06:00","closed_at":"2025-12-22T06:42:20.144842-06:00","close_reason":"Closed"}
{"id":"audio_pro-57r","title":"Bug: ASR tests fail with ENOENT on /mock/whisper-output path","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-23T07:23:18.376277-06:00","updated_at":"2025-12-23T20:10:23.243166-06:00","closed_at":"2025-12-23T20:10:23.243166-06:00","close_reason":"Closed"}
{"id":"audio_pro-5aq","title":"Architecture violation: src/App.tsx:539 lines exceeds 300-line component guideline from CLAUDE.md - split into features/AudioProcessor and features/VideoPreview","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T12:07:02.437058-06:00","updated_at":"2025-12-21T14:13:56.658584-06:00","closed_at":"2025-12-21T14:13:56.658584-06:00","close_reason":"Refactored App.tsx from 709 to 546 lines (-23%) by extracting job progress logic into useJobProgress hook and JobProgressBanner component. All 122 tests passing. Commit: 6ddcea2"}
{"id":"audio_pro-5av","title":"Bug: ffprobe spawn lacks job tracking (ffmpeg-manager.ts:356)","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-25T12:22:39.042772-06:00","updated_at":"2025-12-25T12:42:09.645045-06:00","closed_at":"2025-12-25T12:42:09.645045-06:00","close_reason":"Fixed in Wave 1"}
{"id":"audio_pro-5fd","title":"Test coverage gap: src/__tests__/app.test.tsx only has smoke tests - no unit tests for FFmpeg filter chain builders in electron/main.ts:97-232","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T12:07:06.270894-06:00","updated_at":"2025-12-21T14:38:01.337134-06:00","closed_at":"2025-12-21T14:38:01.337134-06:00","close_reason":"Closed"}
{"id":"audio_pro-5yc","title":"Tech debt: App.tsx at 363 lines exceeds 300 line architecture limit","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-23T06:54:33.859399-06:00","updated_at":"2025-12-23T07:37:53.13937-06:00","closed_at":"2025-12-23T07:37:53.13937-06:00","close_reason":"Closed"}
{"id":"audio_pro-69e","title":"App.tsx:183-190 useEffect with setTimeout for transcript loading - use proper async effect pattern","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-22T06:11:28.238271-06:00","updated_at":"2025-12-23T07:37:53.138073-06:00","closed_at":"2025-12-23T07:37:53.138073-06:00","close_reason":"Closed"}
{"id":"audio_pro-6a2","title":"Missing error handling: electron/main.ts:85 uses non-null assertion on mainWindow without checking if it exists","status":"tombstone","priority":2,"issue_type":"bug","created_at":"2025-12-21T11:54:52.085558-06:00","updated_at":"2025-12-21T12:01:32.788835-06:00","deleted_at":"2025-12-21T12:01:32.788835-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"bug"}
{"id":"audio_pro-849","title":"Memory leak: src/components/Knob.tsx:77-99 useEffect cleanup may not fire if component unmounts during drag","status":"tombstone","priority":2,"issue_type":"bug","created_at":"2025-12-21T11:54:57.713796-06:00","updated_at":"2025-12-21T12:01:32.787544-06:00","deleted_at":"2025-12-21T12:01:32.787544-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"bug"}
{"id":"audio_pro-89e","title":"Missing validation: src/App.tsx:109-110 uses non-null assertion on result paths without checking success first","status":"tombstone","priority":2,"issue_type":"bug","created_at":"2025-12-21T11:55:05.453239-06:00","updated_at":"2025-12-21T12:01:32.786504-06:00","deleted_at":"2025-12-21T12:01:32.786504-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"bug"}
{"id":"audio_pro-8bs","title":"Resource leak: electron/main.ts:234-258 runFFmpeg spawned processes not tracked - no cleanup on app quit or window close","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-21T12:06:58.524441-06:00","updated_at":"2025-12-21T12:55:20.62853-06:00","closed_at":"2025-12-21T12:55:20.62853-06:00","close_reason":"Implemented managed FFmpeg job lifecycle:\n\n1. FFmpegJob abstraction with registry tracking (electron/main.ts:20-31)\n2. Enhanced runFFmpeg() with:\n   - Unique job ID generation\n   - Process registration and deregistration\n   - 5-minute timeout enforcement (configurable)\n   - Guaranteed cleanup on all exit paths (success, error, timeout)\n   - Structured error types (TIMEOUT, CANCELLED, NON_ZERO_EXIT, SPAWN_FAILED)\n\n3. IPC cancellation support via 'cancel-render' handler (electron/main.ts:674-693)\n   - Jobs can be cancelled from UI\n   - Process killed with SIGTERM, escalates to SIGKILL if needed\n   \n4. App lifecycle cleanup (electron/main.ts:173-186)\n   - All active FFmpeg jobs terminated on app quit\n   - Idempotent cleanup, safe to call multiple times\n   \n5. Error handling improvements (electron/main.ts:641-662)\n   - Distinguishes user cancellation, timeout, spawn failure, non-zero exit\n   - Structured FFmpegError interface with type discrimination\n   \n6. Comprehensive test coverage (electron/__tests__/ffmpeg-jobs.test.ts)\n   - 13 tests for job registration, cleanup, timeout, app quit scenarios\n   - All tests passing (38 total across project)\n\nAcceptance criteria met:\n✓ No FFmpeg process exists without being tracked\n✓ No tracked process exits without cleanup\n✓ Cancellation always works\n✓ Timeout always works (5min default)\n✓ App quit leaves zero FFmpeg processes behind"}
{"id":"audio_pro-8jx","title":"electron/main.ts:1457 lines violates single responsibility - split into modules (ffmpeg-manager, path-validation, protocol-handler)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T06:11:21.34968-06:00","updated_at":"2025-12-22T06:42:20.147265-06:00","closed_at":"2025-12-22T06:42:20.147265-06:00","close_reason":"Closed"}
{"id":"audio_pro-a52","title":"Inline styles bloat: App.tsx contains 400+ lines of inline React styles - extract to CSS/styled components","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-21T11:54:50.089051-06:00","updated_at":"2025-12-21T12:01:32.789337-06:00","deleted_at":"2025-12-21T12:01:32.789337-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"audio_pro-aq5","title":"Security: Missing CSP in renderer","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-25T12:22:34.152657-06:00","updated_at":"2025-12-25T12:42:09.64309-06:00","closed_at":"2025-12-25T12:42:09.64309-06:00","close_reason":"Fixed in Wave 1"}
{"id":"audio_pro-atl","title":"Unused import: 'resolve' at vite.config.ts:5 is imported but never used","status":"tombstone","priority":3,"issue_type":"chore","created_at":"2025-12-21T11:54:47.541295-06:00","updated_at":"2025-12-21T12:01:32.791179-06:00","deleted_at":"2025-12-21T12:01:32.791179-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"chore"}
{"id":"audio_pro-b99","title":"electron/main.ts:725-739 buildEQFilter lacks input validation for frequency/q/gain ranges","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-22T06:11:26.721114-06:00","updated_at":"2025-12-23T07:31:14.836055-06:00","closed_at":"2025-12-23T07:31:14.836055-06:00","close_reason":"Closed"}
{"id":"audio_pro-c7l","title":"Missing error boundary: App.tsx has no React ErrorBoundary for graceful failure handling","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-22T06:11:25.824046-06:00","updated_at":"2025-12-23T07:37:53.138778-06:00","closed_at":"2025-12-23T07:37:53.138778-06:00","close_reason":"Closed"}
{"id":"audio_pro-cds","title":"Accessibility: src/App.tsx:532 video element missing aria-label and keyboard controls","status":"tombstone","priority":3,"issue_type":"task","created_at":"2025-12-21T11:55:03.804289-06:00","updated_at":"2025-12-21T12:01:32.790267-06:00","deleted_at":"2025-12-21T12:01:32.790267-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"audio_pro-cn0","title":"Missing error handling: electron/main.ts:234-258 runFFmpeg does not handle spawn timeout or process kill","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-21T12:06:57.58631-06:00","updated_at":"2025-12-21T12:55:20.629378-06:00","closed_at":"2025-12-21T12:55:20.629378-06:00","close_reason":"Implemented managed FFmpeg job lifecycle:\n\n1. FFmpegJob abstraction with registry tracking (electron/main.ts:20-31)\n2. Enhanced runFFmpeg() with:\n   - Unique job ID generation\n   - Process registration and deregistration\n   - 5-minute timeout enforcement (configurable)\n   - Guaranteed cleanup on all exit paths (success, error, timeout)\n   - Structured error types (TIMEOUT, CANCELLED, NON_ZERO_EXIT, SPAWN_FAILED)\n\n3. IPC cancellation support via 'cancel-render' handler (electron/main.ts:674-693)\n   - Jobs can be cancelled from UI\n   - Process killed with SIGTERM, escalates to SIGKILL if needed\n   \n4. App lifecycle cleanup (electron/main.ts:173-186)\n   - All active FFmpeg jobs terminated on app quit\n   - Idempotent cleanup, safe to call multiple times\n   \n5. Error handling improvements (electron/main.ts:641-662)\n   - Distinguishes user cancellation, timeout, spawn failure, non-zero exit\n   - Structured FFmpegError interface with type discrimination\n   \n6. Comprehensive test coverage (electron/__tests__/ffmpeg-jobs.test.ts)\n   - 13 tests for job registration, cleanup, timeout, app quit scenarios\n   - All tests passing (38 total across project)\n\nAcceptance criteria met:\n✓ No FFmpeg process exists without being tracked\n✓ No tracked process exits without cleanup\n✓ Cancellation always works\n✓ Timeout always works (5min default)\n✓ App quit leaves zero FFmpeg processes behind"}
{"id":"audio_pro-deo","title":"Missing error handling: electron/main.ts:261 renderPreview handler doesn't validate file path exists before processing","status":"tombstone","priority":2,"issue_type":"bug","created_at":"2025-12-21T11:54:51.104081-06:00","updated_at":"2025-12-21T12:01:32.789077-06:00","deleted_at":"2025-12-21T12:01:32.789077-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"bug"}
{"id":"audio_pro-dw2","title":"Missing validation: electron/main.ts:261-401 render-preview IPC handler accepts user paths without existence/permission checks before FFmpeg execution","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-21T12:06:59.442761-06:00","updated_at":"2025-12-21T13:01:11.437433-06:00","closed_at":"2025-12-21T13:01:11.437433-06:00","close_reason":"Implemented upstream validation and robust probing:\n\n## Path Validation (DW2)\n\nCreated validateMediaPath() helper (electron/main.ts:63-130):\n- Checks path is absolute\n- Verifies file exists (fs.statSync)\n- Confirms file is regular file (not directory)\n- Validates file is readable (fs.accessSync)\n- Enforces extension allowlist (14 supported formats: .mp4, .mov, .mkv, etc.)\n- Returns typed result with clear failure reasons:\n  NOT_ABSOLUTE, NOT_FOUND, NOT_READABLE, NOT_FILE, UNSUPPORTED_TYPE\n\nWired into render-preview IPC (electron/main.ts:688-696):\n- Validates input path BEFORE any FFmpeg/ffprobe execution\n- Fails fast with clear error messages\n- No process spawn on invalid paths\n\n## Robust Probing (503)\n\nReplaced ffmpeg stderr parsing with ffprobe JSON (electron/main.ts:162-205):\n- Uses ffprobe with -print_format json -show_streams -show_format\n- Parses structured JSON (not fragile regex on stderr)\n- Returns FFprobeResult with typed streams and format\n- Much faster (no video decode needed)\n- Deterministic audio stream detection\n\nUpdated render-preview probe (electron/main.ts:722-741):\n- Calls probeMediaMetadata() instead of runFFmpeg()\n- Checks metadata.streams for codec_type === 'audio'\n- Structured error handling for probe failures\n\n## Test Coverage\n\nAdded electron/__tests__/validation.test.ts (16 tests):\n- Absolute path requirements\n- File existence checks\n- File type validation (reject directories)\n- Extension allowlist enforcement (case-insensitive)\n- Readability checks\n- Edge cases: spaces, unicode, special chars\n- Error message quality\n- All 54 tests passing ✓\n\n## Acceptance Criteria Met\n\n✓ No FFmpeg/ffprobe starts with invalid/unreadable path\n✓ All probing uses ffprobe JSON output\n✓ No stderr parsing for metadata remains\n✓ Errors are deterministic and user-actionable\n✓ Validation is comprehensive (existence, type, permissions, extension)\n✓ Fail-fast design prevents wasted work"}
{"id":"audio_pro-f02","title":"Unused import: src/components/Knob.tsx:1 imports useState but only uses it for Toggle component - consider splitting file","status":"tombstone","priority":3,"issue_type":"chore","created_at":"2025-12-21T11:54:58.508304-06:00","updated_at":"2025-12-21T12:01:32.790961-06:00","deleted_at":"2025-12-21T12:01:32.790961-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"chore"}
{"id":"audio_pro-fr6","title":"Bug: protocol-handler.ts missing error event to renderer","status":"open","priority":3,"issue_type":"bug","created_at":"2025-12-25T12:22:43.326611-06:00","updated_at":"2025-12-25T12:22:43.326611-06:00"}
{"id":"audio_pro-fv9","title":"Chore: Remove duplicate FFmpeg runner (ffmpeg-runner.ts unused)","status":"open","priority":3,"issue_type":"chore","created_at":"2025-12-25T12:22:44.165284-06:00","updated_at":"2025-12-25T12:22:44.165284-06:00"}
{"id":"audio_pro-fve","title":"Code duplication: electron/main.ts:305-326 and 358-391 contain nearly identical fallback logic - extract helper","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-21T11:55:01.196021-06:00","updated_at":"2025-12-21T12:01:32.787281-06:00","deleted_at":"2025-12-21T12:01:32.787281-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"audio_pro-g52","title":"Missing progress reporting: electron/main.ts:234-258 runFFmpeg captures stderr but does not parse FFmpeg progress for UI feedback during long renders","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T12:07:09.610868-06:00","updated_at":"2025-12-21T13:33:46.717468-06:00","closed_at":"2025-12-21T13:33:46.717468-06:00","close_reason":"Implemented comprehensive job-level progress reporting for FFmpeg operations.\n\n**Progress Parsing (electron/main.ts:76-105)**\n- parseFFmpegProgress() extracts time from FFmpeg stderr\n- Supports 3 patterns: HH:MM:SS.ms, time=seconds, out_time_ms=microseconds\n- Returns {positionSeconds, rawLine} or null\n\n**Progress Emission (electron/main.ts:115-176)**\n- emitProgress() sends throttled 'job:progress' IPC events (max 10/sec)\n- emitTerminalState() sends final state (completed/failed/cancelled/timed_out)\n- Events include: jobId, status, percent (0-1), positionSeconds, durationSeconds, phase\n\n**FFmpeg Integration (electron/main.ts:833-950)**\n- Enhanced runFFmpeg() to accept durationSeconds and phase parameters\n- Parses stderr line-by-line for progress\n- Emits queued → running → completed/failed/timed_out states\n- tryRenderStrategies() passes duration and phase through\n\n**IPC Bridge (electron/preload.ts:26-33)**\n- Added onJobProgress() to expose progress events to renderer\n- Returns cleanup function to remove listener\n\n**UI Display (src/App.tsx:41-44, 76-97, 172-188, 569-577)**\n- Added progress state: phase, percent, indeterminate\n- useEffect subscribes to 'job:progress' events\n- Status text shows phase and percent during rendering\n- HTML progress bar (determinate when duration known, indeterminate otherwise)\n\n**Tests (electron/__tests__/progress.test.ts)**\n- 22 new tests for parser (all stderr patterns)\n- Tests for percent calculation, clamping, indeterminate mode\n- Tests for throttling behavior\n\n**Results:**\n- All 86 tests passing (64 previous + 22 new)\n- Zero orphaned processes\n- Real-time progress updates in UI\n- Cancellation stops progress immediately\n- Timeout emits timed_out state"}
{"id":"audio_pro-gts","title":"Security: electron/main.ts:43-51 appfile protocol registered with bypassCSP=true - potential XSS risk if renderer serves untrusted content","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-21T12:06:56.38058-06:00","updated_at":"2025-12-21T13:05:20.532815-06:00","closed_at":"2025-12-21T13:05:20.532815-06:00","close_reason":"Removed unnecessary CSP bypass from appfile:// protocol:\n\n## Change Made (electron/main.ts:291-302)\n\nRemoved bypassCSP: true from protocol registration:\n- BEFORE: bypassCSP: true, stream: true, supportFetchAPI: true  \n- AFTER: stream: true, supportFetchAPI: true\n\n## Why CSP Bypass Was Unnecessary\n\nThe bypassCSP privilege is only needed for protocols that:\n1. Execute inline scripts\n2. Load resources that CSP would block\n\nThe appfile:// protocol serves local media files to \u003cvideo\u003e elements:\n- Video src attributes are not affected by CSP script/style restrictions\n- stream + supportFetchAPI are sufficient for video playback with range requests\n- CSP does NOT block media loaded via \u003cvideo src=\"...\"\u003e\n\n## Verification\n\n✓ All 54 tests pass\n✓ App builds successfully  \n✓ No CSP errors in console\n✓ Electron window launches correctly\n✓ Protocol handler still works (serves approved files via allowlist)\n\n## Security Improvement\n\nRemoving bypassCSP eliminates potential XSS risk if renderer were to:\n- Load untrusted content via appfile://\n- Execute scripts from protocol-served files\n- Bypass Content Security Policy protections\n\nCSP now properly enforces on all content, including appfile:// resources.\n\n## Functionality Preserved\n\n- stream: true → Enables streaming for large media files\n- supportFetchAPI: true → Allows fetch() API usage for Range requests  \n- Video playback via \u003cvideo src=\"appfile://...\"\u003e continues to work\n- All existing security validations (path allowlist) remain in place"}
{"id":"audio_pro-gvc","title":"Code organization: src/components/Knob.tsx exports both Knob and Toggle - violates single responsibility","status":"tombstone","priority":3,"issue_type":"task","created_at":"2025-12-21T11:54:59.561299-06:00","updated_at":"2025-12-21T12:01:32.790738-06:00","deleted_at":"2025-12-21T12:01:32.790738-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"audio_pro-gvt","title":"Test coverage: src/__tests__/app.test.tsx contains only trivial smoke tests - no actual component testing","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-21T11:54:55.814972-06:00","updated_at":"2025-12-21T12:01:32.788065-06:00","deleted_at":"2025-12-21T12:01:32.788065-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"audio_pro-hjj","title":"Dead code: .gitignore:3 ignores dist-electron but vite.config.ts:15,29 builds to dist-electron - verify this is intentional for dev workflow","status":"closed","priority":3,"issue_type":"chore","created_at":"2025-12-21T12:07:04.280641-06:00","updated_at":"2025-12-21T14:35:42.784021-06:00","closed_at":"2025-12-21T14:35:42.784021-06:00","close_reason":"Closed"}
{"id":"audio_pro-ho4","title":"Security: electron/main.ts:60 allows resolving any absolute path via appfile protocol without validation","status":"tombstone","priority":1,"issue_type":"bug","created_at":"2025-12-21T11:54:55.080186-06:00","updated_at":"2025-12-21T12:01:32.78509-06:00","deleted_at":"2025-12-21T12:01:32.78509-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"bug"}
{"id":"audio_pro-hp3","title":"electron/final-render.ts:108-148,153-198 duplicate FFmpeg spawn logic - extract runFFmpegSegment utility","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T06:11:24.691386-06:00","updated_at":"2025-12-22T06:42:20.146637-06:00","closed_at":"2025-12-22T06:42:20.146637-06:00","close_reason":"Closed"}
{"id":"audio_pro-i8l","title":"Missing accessibility: Knob component has no keyboard navigation (arrow keys, focus management)","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-22T06:11:29.184434-06:00","updated_at":"2025-12-23T07:31:14.832707-06:00","closed_at":"2025-12-23T07:31:14.832707-06:00","close_reason":"Closed"}
{"id":"audio_pro-ihy","title":"Bug: audio-extraction.ts lacks path validation (main.ts:366)","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-25T12:22:36.045685-06:00","updated_at":"2025-12-25T12:22:36.045685-06:00"}
{"id":"audio_pro-jdi","title":"Temp file accumulation: electron/main.ts:267-268,274-277 creates uniquely named preview files but no automatic cleanup strategy","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T12:07:00.238549-06:00","updated_at":"2025-12-21T14:05:47.631617-06:00","closed_at":"2025-12-21T14:05:47.631617-06:00","close_reason":"Implemented centralized temp file lifecycle management with per-job scoping, deterministic cleanup, and PRESERVE_TEMP_FILES debug flag. All 122 tests passing. Commit: 8d9585e"}
{"id":"audio_pro-ka8","title":"electron/final-render.ts:53-82 spawns ffmpeg processes without job tracking or cancellation support","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-22T06:11:23.891041-06:00","updated_at":"2025-12-22T06:42:20.145964-06:00","closed_at":"2025-12-22T06:42:20.145964-06:00","close_reason":"Closed"}
{"id":"audio_pro-lne","title":"App.tsx:711 lines exceeds 300-line guideline - extract AudioControls and TranscriptPane components","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T06:11:22.302917-06:00","updated_at":"2025-12-22T06:42:20.147878-06:00","closed_at":"2025-12-22T06:42:20.147878-06:00","close_reason":"Closed"}
{"id":"audio_pro-luj","title":"Component size violation: App.tsx at 538 lines exceeds architectural limit of 300 lines per component","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-21T11:54:49.098734-06:00","updated_at":"2025-12-21T12:01:32.78958-06:00","deleted_at":"2025-12-21T12:01:32.78958-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"audio_pro-o52","title":"Bug: iPhone video displays upside down until focus change","description":"iPhone-recorded video displays upside down in VideoPreview component. Clicking on another file (e.g., CLAUDE.md) triggers focus change that fixes orientation. Returning to app flips it back upside down.\n\nRoot cause: Electron/Chromium GPU compositor bug - not video rotation metadata (confirmed via ffprobe).\n\nPotential fixes:\n1. Disable hardware acceleration for video element\n2. Force repaint after video loads  \n3. Add will-change: transform CSS hint\n\nFile: src/components/VideoPreview.tsx","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-23T23:52:58.001296-06:00","updated_at":"2025-12-25T12:42:09.644286-06:00","closed_at":"2025-12-25T12:42:09.644286-06:00","close_reason":"Fixed in Wave 1"}
{"id":"audio_pro-o5q","title":"Bug: extractAudioForASR lacks timeout (audio-extraction.ts:36)","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-25T12:22:40.653091-06:00","updated_at":"2025-12-25T12:22:40.653091-06:00"}
{"id":"audio_pro-okc","title":"Missing cancellation: electron/main.ts:234-258 runFFmpeg returns Promise but provides no way to cancel in-progress renders from UI","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T12:07:07.395599-06:00","updated_at":"2025-12-21T12:55:20.627133-06:00","closed_at":"2025-12-21T12:55:20.627133-06:00","close_reason":"Implemented managed FFmpeg job lifecycle:\n\n1. FFmpegJob abstraction with registry tracking (electron/main.ts:20-31)\n2. Enhanced runFFmpeg() with:\n   - Unique job ID generation\n   - Process registration and deregistration\n   - 5-minute timeout enforcement (configurable)\n   - Guaranteed cleanup on all exit paths (success, error, timeout)\n   - Structured error types (TIMEOUT, CANCELLED, NON_ZERO_EXIT, SPAWN_FAILED)\n\n3. IPC cancellation support via 'cancel-render' handler (electron/main.ts:674-693)\n   - Jobs can be cancelled from UI\n   - Process killed with SIGTERM, escalates to SIGKILL if needed\n   \n4. App lifecycle cleanup (electron/main.ts:173-186)\n   - All active FFmpeg jobs terminated on app quit\n   - Idempotent cleanup, safe to call multiple times\n   \n5. Error handling improvements (electron/main.ts:641-662)\n   - Distinguishes user cancellation, timeout, spawn failure, non-zero exit\n   - Structured FFmpegError interface with type discrimination\n   \n6. Comprehensive test coverage (electron/__tests__/ffmpeg-jobs.test.ts)\n   - 13 tests for job registration, cleanup, timeout, app quit scenarios\n   - All tests passing (38 total across project)\n\nAcceptance criteria met:\n✓ No FFmpeg process exists without being tracked\n✓ No tracked process exits without cleanup\n✓ Cancellation always works\n✓ Timeout always works (5min default)\n✓ App quit leaves zero FFmpeg processes behind"}
{"id":"audio_pro-png","title":"Missing tests: src/components/JobProgressBanner.tsx has no test coverage","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-22T06:11:31.90786-06:00","updated_at":"2025-12-23T07:31:14.833951-06:00","closed_at":"2025-12-23T07:31:14.833951-06:00","close_reason":"Closed"}
{"id":"audio_pro-qhf","title":"Missing edge case handling: electron/main.ts:305-326,358-391 video copy fallback to re-encode but no fallback if re-encode also fails","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-21T12:07:03.518818-06:00","updated_at":"2025-12-21T13:15:21.811059-06:00","closed_at":"2025-12-21T13:15:21.811059-06:00","close_reason":"Implemented deterministic render strategy with comprehensive failure handling:\n\n## Problem Solved\n\nWhen both video copy and re-encode attempts failed, the system would:\n- Only report the last failure\n- Lose context of what was tried\n- Provide generic error messages without actionable guidance\n\n## Changes Made\n\n### 1. Explicit Render Attempts (electron/main.ts:561-667)\n\nCreated typed render attempt system:\n- RenderAttempt interface: name (COPY/REENCODE/LAST_RESORT) + args\n- RenderAttemptFailure: captures attempt name, error, stderr tail\n- tryRenderStrategies(): orchestrates sequential attempts with failure collection\n\n### 2. Comprehensive Failure Collection\n\ntryRenderStrategies() behavior:\n- Try each attempt sequentially (COPY → REENCODE)\n- On NON_ZERO_EXIT: record failure, continue to next attempt\n- On TIMEOUT/CANCELLED/SPAWN_FAILED: fail immediately (no retry)\n- If all attempts fail: throw error with ALL failure details\n\n### 3. User-Actionable Error Diagnosis (electron/main.ts:588-611)\n\ndiagnoseFFmpegFailure() maps stderr patterns to guidance:\n- 'unknown encoder' → Missing codec / build issue\n- 'invalid data found' / 'moov atom' → Corrupt file\n- 'permission denied' → File permission issue\n- 'no space left' → Disk full\n- 'unsupported codec' → Unsupported input codec\n\n### 4. Structured Error Messages\n\nFinal error on complete failure includes:\n- Diagnosis from stderr pattern matching\n- List of all attempts with their specific errors\n- Original stderr for debugging\n- Exit code if available\n\nExample:\n\"All render attempts failed. Missing video codec. FFmpeg may not be built with required encoders.\nAttempts: COPY: codec not supported for copying; REENCODE: encoder libx264 not found\"\n\n### 5. Refactored Render Paths (electron/main.ts:852-940)\n\nBoth original and processed preview renders now use tryRenderStrategies:\n- Original: COPY → REENCODE\n- Processed: COPY (with filters) → REENCODE (with filters)\n- Automatic fallback without manual try/catch\n- Consistent error handling across both paths\n\n### 6. Comprehensive Test Coverage (electron/__tests__/render-strategies.test.ts)\n\n10 new tests covering:\n- COPY succeeds (fast path)\n- COPY fails, REENCODE succeeds (fallback path)\n- Both fail with comprehensive error\n- TIMEOUT/CANCELLED/SPAWN_FAILED propagate immediately\n- Failure details preserved from both attempts\n- User diagnosis messages included\n- All 64 tests passing ✓\n\n## Acceptance Criteria Met\n\n✓ If copy fails and re-encode fails, app returns structured final failure\n✓ Both failures preserved for diagnosis\n✓ No hangs or orphan jobs\n✓ Existing lifecycle/cancel/timeout behavior intact\n✓ User-actionable error messages\n✓ Deterministic behavior (no silent failures)"}
{"id":"audio_pro-t9x","title":"Duplicate gradient IDs: src/components/Knob.tsx:132-140 uses size-based IDs that may collide with multiple knobs","status":"tombstone","priority":2,"issue_type":"bug","created_at":"2025-12-21T11:54:56.633071-06:00","updated_at":"2025-12-21T12:01:32.787811-06:00","deleted_at":"2025-12-21T12:01:32.787811-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"bug"}
{"id":"audio_pro-tvk","title":"Hardcoded value: electron/main.ts:17 uses process.cwd() for tmp directory - should use app.getPath('temp')","status":"tombstone","priority":2,"issue_type":"bug","created_at":"2025-12-21T11:54:53.253566-06:00","updated_at":"2025-12-21T12:01:32.788567-06:00","deleted_at":"2025-12-21T12:01:32.788567-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"bug"}
{"id":"audio_pro-uag","title":"Missing dist directory in gitignore: .gitignore missing dist/ folder referenced in vite.config.ts:37 and package.json:38-40","status":"closed","priority":3,"issue_type":"chore","created_at":"2025-12-21T12:07:05.360804-06:00","updated_at":"2025-12-21T14:35:47.161268-06:00","closed_at":"2025-12-21T14:35:47.161268-06:00","close_reason":"Closed"}
{"id":"audio_pro-uwp","title":"Performance: src/App.tsx:88-124 handleRender not memoized with useCallback dependencies - may cause unnecessary re-renders","status":"tombstone","priority":3,"issue_type":"task","created_at":"2025-12-21T11:55:04.673036-06:00","updated_at":"2025-12-21T12:01:32.790041-06:00","deleted_at":"2025-12-21T12:01:32.790041-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"audio_pro-w8d","title":"Missing type safety: src/App.tsx:11-27 duplicates types from shared/types.ts instead of importing Window interface","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-21T11:55:02.704183-06:00","updated_at":"2025-12-21T12:01:32.786895-06:00","deleted_at":"2025-12-21T12:01:32.786895-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"audio_pro-yz5","title":"Missing cleanup: electron/main.ts:274-278 manually deletes files but no error handling if deletion fails","status":"tombstone","priority":3,"issue_type":"bug","created_at":"2025-12-21T11:55:00.309896-06:00","updated_at":"2025-12-21T12:01:32.790509-06:00","deleted_at":"2025-12-21T12:01:32.790509-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"bug"}
{"id":"audio_pro-z5z","title":"Bug: final-render.ts missing path validation (main.ts:407)","status":"open","priority":1,"issue_type":"bug","created_at":"2025-12-25T12:22:38.073339-06:00","updated_at":"2025-12-25T12:22:38.073339-06:00"}
